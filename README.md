# ThemeSearcher
Асинхронный HTTP-сервер, обрабатывающий поисковые запросы пользователей.

- Сервис принимает текстовый запрос пользователя.
Пример URL (при условии, что сервер запущен на локальной машине на порту 9090):
```
http://localhost:9090/?query=купить%20слона
```
- Определяет, к какой теме или темам может принадлежать запрос (подробности см. ниже).
- Выдает результат в формате json, в котором указан список соответствующих запросу тем.<br>
Пример результата: 
```
>>> requests.get("http://localhost:9090/?query=рецепты тайской кухни").json()
{
  "themes":[
    "товары",
    "книги",
    "кухня",
    "фильмы"
  ],
  "query":"рецепты китайской и тайская кухня"
}
```

Каждая тема определяется набором фраз, например:
- новости: "деревья на Садовом кольце", "добрый автобус", "выставка IT-технологий";
- кухня: "рецепт борща", "яблочный пирог", "тайская кухня";
- товары: "Дети капитана Гранта", "зимние шины", "Тайская кухня";
или любые другие, на ваше усмотрение. Важно, чтобы какая-то из фраз встретилась в нескольких наборах индексов, как "тайская кухня" в примере.

Предполагается, что наборы фраз все умещаются в оперативной памяти, но при этом могут быть достаточно большими.

Правило принадлежности запроса теме:
1. Если набор слов из запроса содержит в себе все слова какой-либо из фраз, то запрос считается соответствующим теме. Иначе - не соответствующим.
2. Порядок слов в запросе и во фразах не учитывается.

### Установка
Чтобы установить пакет, нужно выполнить следующие команды в папке проекта:
```
virtualenv venv
source venv/bin/activate
python3 setup.py install
```

В папке проекта должна лежать папка **data** с файлами: 
 - **phrases.json** - темы с фразами
 - **stopwords.txt** - стоп-слова, которые не учитываются при построении индекса и поиске тем

Примеры файлов в нужном формате уже есть в папке data.<br>
Также можно указать другой путь к папке data с помощью переменной окружения *THEMESEARCHER_DATA_DIR*.

### Запуск сервера
```
python3 server.py
```
По умолчанию сервер запускается на порту: 9090

### Запуск тестов
Тесты запускаются следующей командой (внутри виртуального окружения):
```
python3 setup.py test
```
